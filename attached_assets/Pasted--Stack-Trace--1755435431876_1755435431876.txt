لفهم السبب الرئيسي للمشكلة من الـ Stack Trace، من المهم جدًا التركيز على السياق والرسالة التي يُظهرها، لأن Stack Trace يوضح متى وأين تم استدعاء الدالة بالفعل.

في حالتك، فتضح مشكلة أن handleAddProject() يتم تنفيذها فورًا عند تعريفها (أو عند إعادة التّصيير) وليس عند النقر على الزر، وهو ما يؤكده الخطأ الذي وصفته.


---

السبب الأكثر شيوعًا: تمرير الدالة بدلاً من تعريفها كـ callback

في React، يُتوقع أن تمرر الدالة فقط كمرجع. ولكن إذا استخدمت القوسين (), فهذا يعني أنك تنفّذها مباشرةً أثناء التصيير:

//  خطأ! سيتم تنفيذ handleAddProject فورًا عند التصيير
<button onClick={handleAddProject()} />

//  صحيح: تمرير الدالة كمرجع لتُنفذ عند النقر فقط
<button onClick={handleAddProject} />

// أو عند الحاجة لتمرير معاملات
<button onClick={() => handleAddProject(arg1, arg2)} />

هذه النقطة مؤكدة في عدة مصادر:

"onClick expects a function … it doesn’t work when you run it like onClick={this.handleClick(i)} because that calls the function immediately" .

"Forgetting () => and writing onClick={alert('click')} … would fire the alert every time the component re-renders" .

التوثيق في موقع React يوضّح أنه يجب تمرير الدالة وليس استدعاؤها: onClick={handleClick}, وليس onClick={handleClick()} .



---

خطوات واضحة لتحديد السبب الجذري:

الخطوة	ما يجب فعله

1	افحص الـ Stack Trace واضعًا في الاعتبار اسم الملف وسطر الاستدعاء، حيث يشير إلى موقع الخطأ بدقة.
2	تحقق من تعريف زرّ النقر: هل كتبت onClick={handleAddProject()}؟ إن كان كذلك، هذا هو السبب.
3	بدّلها إلى onClick={handleAddProject} إذا لم تقم بتمرير معاملات، أو onClick={() => handleAddProject(params)} إن كنت بحاجة لذلك.
4	تأكّد أيضًا من أن handleAddProject هي دالة وليست قيمة تُرجع دالة. إذا كانت ترجع دالة، عندها قد تحتاج المراجع لتكون مختلفة—but هذا نادر.
5	بعد التعديل: أعد التصيير (مثلاً reload الصفحة) ولاحظ إن استمرت المشكلة أو اختفت.
6	إذا استمرت المشكلة: استخدم console.log داخل handleAddProject لمعرفة متى تُنفّذ (خلال التصيير أم أثناء النقر؟).



---

خلاصة

المشكلة التي تواجهها على الأرجح هي بسبب استدعاء الدالة مباشرة أثناء التصيير وليس تمريرها كمرجع. فكر في الأمر هكذا: إذا وضعت () بعد أي دالة داخل JSX، فأنت تقول لـ React: "نفّذها الآن!" — بينما المطلوب: "مرّرها ليتم تنفيذها لاحقًا عند النقر."

جرب ذلك، وإذا واجهت تحديات أخرى أو ظهر خطأ جديد، فقط أخبرني وسأساعدك خطوة بخطوة.

